
<!doctype html>
<html>
    <head>
        <title>  新浪广告  </title>
        <meta charset="utf-8">
        <script type="text/javascript" src="http://d2.sina.com.cn/litong/zhitou/sinaads/release/sinaadToolkit.js"></script>
    </head>
    <body style="margin:0;padding:0">
    <script>
        var par = location.search.substr(1),
            ary = par.split("${}"),
            monitor = ary.slice(5) || [];

        var type = ary[0],
            src = sinaadToolkit.string.encodeHTML(ary[1]),
            link = ary[2],
            width = ary[3] + 'px',
            height = ary[4] + 'px';

        var srcAllowDomain = ['sina\\.com\\.cn','weibo\\.com','sinaimg\\.cn'],
            urlAllowDomain = ['sina\\.com\\.cn','weibo\\.com','allyes\\.com'];

        function checkDomain(url, allowDomain) {
            var reg = new RegExp('^(http|https):\\/\\/([^\\/\\?#]+\\.)*(' + allowDomain.join('|') + ')(\\/|\\?|#|$)');
            return reg.test(url);
        }

        if (type === 'flash' || type === 'image' && checkDomain(link, urlAllowDomain) && checkDomain(src, srcAllowDomain)) {
            document.write(sinaadToolkit.ad.createHTML(
                type,
                src,
                width,
                height,
                link,
                monitor
            ));
        }
        window.blur();
    </script>
    </body>
</html>

